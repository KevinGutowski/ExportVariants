(()=>{let e;function t(){let t=figma.currentPage.selection;if(e=t.filter((e=>"COMPONENT_SET"===e.type)),0==t.length)return null;if(e.length>0){let t=e[e.length-1];return{componentSetsLength:e.length,numberOfComponents:n(e),firstComponentSet:{metaData:a(t.children[0])}}}return null}function n(e){let t=0;return e.forEach((e=>{t+=e.children.length})),t}function a(e){let t=e.parent.name.toLowerCase(),n=e.name.split(", "),a=[],r=[];n.forEach((e=>{let t=e.split("=");r.push(t[1]),a.push(t[0])}));let o="",s=["yes","true","no","false"],i=["no","false"];return r.forEach(((e,t)=>{-1===s.indexOf(e.toLowerCase())?o+=`-${e.toLowerCase()}`:-1===i.indexOf(e.toLowerCase())&&(o+=`-${a[t].toLowerCase()}`)})),o=o.substring(1),{componentName:t,variantSubstring:o}}figma.clientStorage.getAsync("preference").then((e=>{figma.showUI(__html__,{width:276,height:184}),figma.ui.postMessage({type:"setup",data:t(),preference:e})})),figma.on("selectionchange",(()=>{figma.ui.postMessage({type:"selectionChange",data:t()})})),figma.ui.onmessage=t=>{if("preference"===t.type&&figma.clientStorage.setAsync("preference",t.preference),"export"===t.type){let t=[],n=[];e.forEach((e=>{e.children.forEach((e=>{let r=e.exportAsync({format:"SVG"}),o=a(e);n.push(o),t.push(r)}))})),Promise.all(t).then((e=>{figma.ui.postMessage({type:"download",data:{svgDataArray:e,variantDataArray:n}})}))}}})();